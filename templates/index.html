<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Wildfire Defenders</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@200..900&family=Sigmar+One&display=swap');
    body { 
      font-family: "Sigmar One", sans-serif;
      font-weight: 400;
      font-style: normal;
      background: #e6ffe6; /* soft green background */
      margin: 0; 
      padding: 0; 
      text-align: center; 
      color: #3F2A2B; /* deep green text */
      overflow:hidden;
    }
    .page { 
      display: none; 
      height: 100vh; 
      justify-content: center; 
      align-items: center; 
      flex-direction: column; 
      padding: 0; 
      overflow:hidden;
    } 
    #startPage{
      background-image: url('static/images/introBackground.gif'); /* Replace with the path to your GIF */
      background-repeat: no-repeat; /* Prevents the GIF from repeating if it's smaller than the screen */
      background-position: center center; /* Centers the GIF */
      background-size: cover; 
      font-family: "Sigmar One", sans-serif;
      font-weight: 400;
      font-style: normal;
      margin: 0; 
      padding: 0; 
      text-align: center; 
      color: #3F2A2B; /* deep green text */
    }
    #gamePage{
      background-image: url('static/images/Background.jpg');
    }
    .content {
      background:#d8808051;
      height: 100vh;
      width: 100vw;
      display: grid;
    }

    .logo, .startButton {
      grid-column: 1;
    }

    .column{
      flex: 1;
      padding: 20px;
    }
    
    .active { display: flex; }
    button { 
      margin: -5px; 
      padding: 18px 26px; 
      font-size: 18px; 
      border-radius: 8px; 
      border: none; 
      cursor: pointer; 
      background-color: #D8C380; /* forest green */
      color: white; 
      transition: background-color 0.3s ease;
      font-family: "Sigmar One", sans-serif;
      font-weight: 400;
      font-style: normal;
    }
    button:hover { background-color: #1f5d3d; }
    h1, h2 { color: #3F2A2B; }
    #p5host { margin-top: 0; }
  </style>
  <!-- p5.js -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.2/p5.js"></script>
  <!-- your sketch -->
  <script src="{{ url_for('static', filename='js/sketch.js') }}"></script>
  <!-- ml5.js -->
  <script src="https://unpkg.com/ml5@latest/dist/ml5.min.js"></script>

</head>
<body>
  <!-- Starter Page -->
  <div id="startPage" class="page active">
    <div class="content">
      <div class="logo" style = "grid-row:2;">
      <img src="{{ url_for('static', filename='images/LOGO.png') }}" alt="Google Gemini Generated Photo" 
      style="width: 900px;">
      </div>
      <div class="startButton" style = "grid-row: 3;">
      <button onclick="showPage('menuPage'), connect()" style = "font-size: 50px;"  >Start</button>
      </div>
    </div>
  </div>

  <!-- Menu Page -->
  <div id="menuPage" class="page">
    <h1>Main Menu</h1>
    <div class="column">
      <h2>How to Play</h2>
      <p>Move with arrow keys or controller. Stand on fires and press the correct pin to extinguish them.</p>
      <h2>Forest Info</h2>
      <p>Forests are vital ecosystems. Fires destroy habitats, but safety measures protect them.</p>
      <h2>About Us</h2>
      <p>We are a team passionate about fire safety and education.</p>
    </div>
    <div class="column">
      <h1>How to use the Controller</h1>
      <p>blah blah balh</p>
    </div>
    <button onclick="showPage('mapPage')">Play</button>
    <button onclick="goBack()">â¬… Back</button>
  </div>

  <!-- Map Selection Page -->
  <div id="mapPage" class="page">
    <h1>Select a Forest</h1>
    <button onclick="startGame('Amazon Rain Forest')">ðŸŒ³ Amazon Rain Forest</button>

    <button onclick="goBack()">â¬… Back</button>
  </div>

  <!-- Game Page -->
  <div id="gamePage" class="page">
    <div id="p5host"></div>
  </div>

  <script>
    let historyStack = [];

    function showPage(id) {
      const current = document.querySelector('.page.active');
      if (current) {
        historyStack.push(current.id);
        current.classList.remove('active');
      }
      document.getElementById(id).classList.add('active');
    }

    function goBack() {
      const current = document.querySelector('.page.active');
      if (current) current.classList.remove('active');

      const prev = historyStack.pop();
      if (prev) {
        document.getElementById(prev).classList.add('active');
      } else {
        document.getElementById("startPage").classList.add('active');
      }
    }

    function startGame(map) {
      //window.selectedMap = map;
      //document.getElementById("mapName").textContent = "Map: " + map;
      showPage('gamePage');

      // Remove old game if it exists
      if (window.currentGame) {
        window.currentGame.remove();
      }
      // Start new game
      window.currentGame = new p5(gameSketch, "p5host");
    }
  </script>
</body>
</html>
